version: '3.8'
services:
  suno-api:
    build: ./suno-api
    container_name: reso-suno-api
    volumes:
      - ./.env:/app/.env:ro
      - ./load-env.js:/app/load-env.js:ro
    command: ["node", "-r", "/app/load-env.js", "node_modules/.bin/next", "start"]
    ports:
      - "3001:3000"
    restart: unless-stopped

  backend:
    build: ./backend
    container_name: reso-backend
    volumes:
      - ./.env:/app/.env:ro
    environment:
      - SUNO_API_URL=http://suno-api:3000
    ports:
      - "8000:8000"
    depends_on:
      - suno-api
    restart: unless-stopped

  frontend:
    build: ./frontend
    container_name: reso-frontend
    ports:
      - "3000:3000"
    depends_on:
      - backend
